
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juegos de Pensamiento - INIFAP Chiapas</title>
    <style>
        :root {
            --verde-primario: #0b5345;
            --verde-secundario: #148a74;
            --verde-claro: #1abc9c;
            --verde-oscuro: #053d36;
            --verde-medio: #16a085;
            --blanco: #ffffff;
            --gris-claro: #ecf0f1;
            --gris: #7f8c8d;
            --gris-oscuro: #2c3e50;
            --sombra-principal: rgba(11, 83, 69, 0.25);
            --sombra-suave: rgba(11, 83, 69, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--verde-primario) 0%, var(--verde-secundario) 50%, var(--verde-claro) 100%);
            min-height: 100vh;
            color: #333;
        }

        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2316a085' fill-opacity='0.1'%3E%3Cpath d='M30 15c0 8.284-6.716 15-15 15s-15-6.716-15-15S6.716 0 15 0s15 6.716 15 15zm15 15c0 8.284-6.716 15-15 15s-15-6.716-15-15 6.716-15 15-15 15 6.716 15 15z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E") repeat;
            animation: float 25s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-30px) rotate(3deg); }
        }

        /* Panel lateral */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 320px;
            height: 100vh;
            background: linear-gradient(180deg, var(--verde-oscuro), var(--verde-primario));
            box-shadow: 5px 0 25px var(--sombra-principal);
            z-index: 1000;
            overflow-y: auto;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar.collapsed {
            transform: translateX(-280px);
        }

        .sidebar-toggle {
            position: absolute;
            right: -50px;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 60px;
            background: linear-gradient(135deg, var(--verde-oscuro), var(--verde-primario));
            border: none;
            border-radius: 0 15px 15px 0;
            color: var(--blanco);
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 3px 0 15px var(--sombra-principal);
            transition: all 0.3s ease;
        }

        .sidebar-toggle:hover {
            background: linear-gradient(135deg, var(--verde-primario), var(--verde-claro));
            transform: translateY(-50%) scale(1.1);
        }

        .sidebar-header {
            padding: 25px 20px;
            text-align: center;
            border-bottom: 2px solid rgba(255,255,255,0.2);
            background: rgba(0,0,0,0.1);
        }

        .sidebar-header h2 {
            color: var(--blanco);
            font-size: 1.4rem;
            margin-bottom: 8px;
            font-weight: 800;
        }

        .sidebar-header p {
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .menu-items {
            padding: 20px 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 18px 25px;
            color: var(--blanco);
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            position: relative;
        }

        .menu-item:hover {
            background: rgba(255,255,255,0.1);
            border-left-color: var(--verde-claro);
            transform: translateX(5px);
        }

        .menu-item.active {
            background: rgba(255,255,255,0.15);
            border-left-color: var(--verde-claro);
            box-shadow: inset 0 0 20px rgba(0,0,0,0.2);
        }

        .menu-item .icon {
            font-size: 1.5rem;
            margin-right: 15px;
            width: 30px;
            text-align: center;
        }

        .menu-item .text {
            flex: 1;
        }

        .menu-item .title {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 3px;
        }

        .menu-item .desc {
            font-size: 0.8rem;
            opacity: 0.85;
            font-weight: 400;
        }

        /* √Årea principal */
        .main-content {
            margin-left: 320px;
            padding: 30px;
            min-height: 100vh;
            transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .main-content.expanded {
            margin-left: 40px;
        }

        .welcome-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: calc(100vh - 60px);
            text-align: center;
            color: var(--blanco);
        }

        .welcome-screen h1 {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 20px;
            text-shadow: 3px 3px 10px rgba(0,0,0,0.4);
            animation: fadeInUp 1s ease-out;
        }

        .welcome-screen p {
            font-size: 1.3rem;
            opacity: 0.9;
            max-width: 600px;
            line-height: 1.6;
            animation: fadeInUp 1s ease-out 0.3s both;
        }

        .game-area {
            display: none;
            background: var(--blanco);
            border-radius: 20px;
            padding: 35px;
            margin: 20px 0;
            box-shadow: 0 20px 50px var(--sombra-principal);
            border: 2px solid var(--verde-claro);
            animation: slideInRight 0.6s ease-out;
            position: relative;
        }

        .game-area.active {
            display: block;
        }

        .game-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--verde-claro);
        }

        .game-title {
            font-size: 2.2rem;
            color: var(--verde-oscuro);
            font-weight: 800;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .game-description {
            color: var(--gris);
            font-size: 1.1rem;
            font-weight: 500;
            max-width: 600px;
            margin: 0 auto;
        }

        .close-game {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, var(--verde-oscuro), var(--verde-primario));
            color: var(--blanco);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px var(--sombra-suave);
        }

        .close-game:hover {
            transform: scale(1.1);
            background: linear-gradient(135deg, var(--verde-primario), var(--verde-claro));
        }

        /* Estilos de juegos */
        .btn {
            background: linear-gradient(135deg, var(--verde-oscuro), var(--verde-primario));
            color: var(--blanco);
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            margin: 5px;
            box-shadow: 0 5px 15px var(--sombra-suave);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px var(--sombra-principal);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--gris), #95a5a6);
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            padding: 15px;
            background: rgba(11, 83, 69, 0.08);
            border-radius: 10px;
            font-weight: 600;
            color: var(--verde-oscuro);
        }

        /* Juego de Memoria */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            max-width: 320px;
            margin: 20px auto;
        }

        .memory-card {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--verde-primario), var(--verde-secundario));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            color: var(--blanco);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid var(--verde-oscuro);
        }

        .memory-card:hover {
            transform: scale(1.05);
        }

        .memory-card.flipped {
            background: var(--blanco);
            color: var(--verde-oscuro);
            border: 3px solid var(--verde-primario);
        }

        .memory-card.matched {
            background: linear-gradient(135deg, var(--verde-medio), var(--verde-claro));
            color: var(--verde-oscuro);
            animation: matchPulse 0.6s ease-out;
        }

        @keyframes matchPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Quiz */
        .quiz-question {
            background: rgba(11, 83, 69, 0.08);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 4px solid var(--verde-claro);
        }

        .quiz-question h4 {
            color: var(--verde-oscuro);
            margin-bottom: 15px;
            font-size: 1.15rem;
            font-weight: 700;
        }

        .quiz-option {
            background: var(--blanco);
            border: 2px solid rgba(11, 83, 69, 0.2);
            border-radius: 8px;
            padding: 12px 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 8px 0;
            font-weight: 500;
        }

        .quiz-option:hover {
            border-color: var(--verde-primario);
            background: rgba(11, 83, 69, 0.05);
        }

        .quiz-option.correct {
            background: rgba(22, 160, 133, 0.15);
            border-color: var(--verde-claro);
            color: var(--verde-oscuro);
        }

        .quiz-option.incorrect {
            background: rgba(231, 76, 60, 0.15);
            border-color: #e74c3c;
            color: #c0392b;
        }

        /* Palabras */
        .word-display {
            font-size: 2rem;
            font-weight: 800;
            color: var(--verde-oscuro);
            margin: 20px 0;
            letter-spacing: 8px;
            padding: 20px;
            background: rgba(11, 83, 69, 0.08);
            border-radius: 12px;
            border: 2px solid var(--verde-claro);
        }

        .word-input {
            font-size: 1.2rem;
            padding: 15px 20px;
            border: 2px solid var(--verde-claro);
            border-radius: 10px;
            margin: 10px;
            text-align: center;
            font-weight: 600;
            color: var(--verde-oscuro);
            background: var(--blanco);
            width: 300px;
        }

        /* C√°lculos */
        .calculation-display {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--verde-oscuro);
            margin: 30px 0;
            padding: 25px;
            background: rgba(11, 83, 69, 0.08);
            border-radius: 15px;
            border: 3px solid var(--verde-claro);
            text-align: center;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .number-pad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            max-width: 250px;
            margin: 20px auto;
        }

        .number-btn {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--verde-primario), var(--verde-secundario));
            color: var(--blanco);
            border: none;
            border-radius: 12px;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px var(--sombra-suave);
        }

        .number-btn:hover {
            transform: scale(1.1);
            background: linear-gradient(135deg, var(--verde-medio), var(--verde-claro));
        }

        /* Reflejos */
        .reaction-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            margin: 30px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--gris);
            color: var(--blanco);
        }

        .reaction-circle.active {
            background: linear-gradient(135deg, var(--verde-medio), var(--verde-claro));
            color: var(--verde-oscuro);
            animation: pulse 0.5s ease-out;
        }

        .reaction-circle.wait {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Animaciones */
        @keyframes fadeInUp {
            0% { opacity: 0; transform: translateY(30px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInRight {
            0% { opacity: 0; transform: translateX(50px); }
            100% { opacity: 1; transform: translateX(0); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 280px;
                transform: translateX(-280px);
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }

            .welcome-screen h1 {
                font-size: 2.5rem;
            }

            .memory-grid {
                grid-template-columns: repeat(3, 1fr);
                max-width: 250px;
            }

            .word-input {
                width: 250px;
            }
        }
    </style>
</head>
<body>
    <!-- Panel lateral -->
    <div class="sidebar" id="sidebar">
        <button class="sidebar-toggle" onclick="toggleSidebar()">
            <span id="toggleIcon">‚Äπ</span>
        </button>
        
        <div class="sidebar-header">
            <h2>üåæ INIFAP Chiapas</h2>
            <p>Juegos de Pensamiento L√≥gico</p>
        </div>

        <div class="menu-items">
            <div class="menu-item" onclick="showGame('memory')">
                <div class="icon">üß†</div>
                <div class="text">
                    <div class="title">Memoria Agr√≠cola</div>
                    <div class="desc">Encuentra parejas de cultivos</div>
                </div>
            </div>

            <div class="menu-item" onclick="showGame('quiz')">
                <div class="icon">üå±</div>
                <div class="text">
                    <div class="title">Quiz Agr√≠cola</div>
                    <div class="desc">Conocimientos del campo</div>
                </div>
            </div>

            <div class="menu-item" onclick="showGame('calculations')">
                <div class="icon">üî¢</div>
                <div class="text">
                    <div class="title">C√°lculos R√°pidos</div>
                    <div class="desc">Matem√°ticas agr√≠colas</div>
                </div>
            </div>

            <div class="menu-item" onclick="showGame('words')">
                <div class="icon">üìù</div>
                <div class="text">
                    <div class="title">Palabras Agr√≠colas</div>
                    <div class="desc">Forma palabras del campo</div>
                </div>
            </div>

            <div class="menu-item" onclick="showGame('reaction')">
                <div class="icon">‚ö°</div>
                <div class="text">
                    <div class="title">Reflejos</div>
                    <div class="desc">Tiempo de reacci√≥n</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Contenido principal -->
    <div class="main-content" id="mainContent">
        <!-- Pantalla de bienvenida -->
        <div class="welcome-screen" id="welcomeScreen">
            <h1>üß† Ejercita tu Mente</h1>
            <p>Bienvenido a los juegos de pensamiento l√≥gico de INIFAP Chiapas. Selecciona un juego del men√∫ lateral para comenzar a ejercitar tu mente mientras procesamos tu informaci√≥n.</p>
        </div>

        <!-- Juego de Memoria -->
        <div class="game-area" id="memoryGame">
            <button class="close-game" onclick="closeGame()">√ó</button>
            <div class="game-header">
                <div class="game-title">üß† Memoria Agr√≠cola</div>
                <div class="game-description">Encuentra las parejas de cultivos y herramientas del campo chiapaneco</div>
            </div>
            <div class="game-stats">
                <span>Movimientos: <span id="memoryMoves">0</span></span>
                <span>Parejas: <span id="memoryPairs">0</span>/6</span>
                <span>Tiempo: <span id="memoryTime">0</span>s</span>
            </div>
            <div class="memory-grid" id="memoryGrid"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" onclick="startMemoryGame()">üéÆ Nuevo Juego</button>
            </div>
        </div>

        <!-- Juego Quiz -->
        <div class="game-area" id="quizGame">
            <button class="close-game" onclick="closeGame()">√ó</button>
            <div class="game-header">
                <div class="game-title">üå± Quiz Agr√≠cola</div>
                <div class="game-description">Demuestra tus conocimientos sobre agricultura en Chiapas</div>
            </div>
            <div class="game-stats">
                <span>Pregunta: <span id="quizCurrent">1</span>/5</span>
                <span>Correctas: <span id="quizCorrect">0</span></span>
                <span>Puntuaci√≥n: <span id="quizScore">0</span>%</span>
            </div>
            <div id="quizContainer"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" onclick="startQuizGame()">üéØ Comenzar Quiz</button>
            </div>
        </div>

        <!-- Juego de C√°lculos -->
        <div class="game-area" id="calculationsGame">
            <button class="close-game" onclick="closeGame()">√ó</button>
            <div class="game-header">
                <div class="game-title">üî¢ C√°lculos Agr√≠colas R√°pidos</div>
                <div class="game-description">Resuelve operaciones matem√°ticas relacionadas con la agricultura</div>
            </div>
            <div class="game-stats">
                <span>Nivel: <span id="calcLevel">1</span></span>
                <span>Correctas: <span id="calcCorrect">0</span></span>
                <span>Tiempo: <span id="calcTime">30</span>s</span>
            </div>
            <div class="calculation-display" id="calcDisplay">Presiona Iniciar</div>
            <div class="number-pad" id="numberPad"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" onclick="startCalculationGame()">üöÄ Iniciar</button>
                <button class="btn btn-secondary" onclick="clearCalcInput()">üóëÔ∏è Limpiar</button>
                <button class="btn btn-secondary" onclick="submitCalcAnswer()">‚úì Enviar</button>
            </div>
        </div>

        <!-- Juego de Palabras -->
        <div class="game-area" id="wordsGame">
            <button class="close-game" onclick="closeGame()">√ó</button>
            <div class="game-header">
                <div class="game-title">üìù Palabras Agr√≠colas</div>
                <div class="game-description">Forma palabras relacionadas con la agricultura usando las letras disponibles</div>
            </div>
            <div class="game-stats">
                <span>Palabras: <span id="wordsFound">0</span></span>
                <span>Puntos: <span id="wordsScore">0</span></span>
                <span>Tiempo: <span id="wordsTime">120</span>s</span>
            </div>
            <div style="text-align: center; padding: 20px;">
                <div class="word-display" id="wordLetters">AGRICULTURA</div>
                <input type="text" class="word-input" id="wordInput" placeholder="Escribe una palabra aqu√≠" 
                       onkeypress="checkWordInput(event)">
                <div id="wordFeedback" style="margin: 20px 0; font-size: 1.1rem; font-weight: 600;"></div>
                <div id="foundWords" style="margin-top: 20px;">
                    <strong>Palabras encontradas:</strong>
                    <div id="wordsList" style="margin-top: 10px; font-weight: 500;"></div>
                </div>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" onclick="startWordGame()">üéØ Nueva Palabra</button>
            </div>
        </div>

        <!-- Juego de Reflejos -->
        <div class="game-area" id="reactionGame">
            <button class="close-game" onclick="closeGame()">√ó</button>
            <div class="game-header">
                <div class="game-title">‚ö° Test de Reflejos</div>
                <div class="game-description">Prueba qu√© tan r√°pidos son tus reflejos haciendo clic cuando cambie el color</div>
            </div>
            <div class="game-stats">
                <span>Mejor: <span id="reactionBest">0</span>ms</span>
                <span>Promedio: <span id="reactionAvg">0</span>ms</span>
                <span>Intentos: <span id="reactionTries">0</span></span>
            </div>
            <div style="text-align: center; padding: 40px;">
                <div class="reaction-circle" id="reactionCircle" onclick="handleReactionClick()">
                    Haz clic para comenzar
                </div>
                <div id="reactionResult" style="margin-top: 20px; font-size: 1.2rem; font-weight: 600;"></div>
            </div>
        </div>
    </div>

    <script>
        let currentGameActive = null;
        let gameTimers = {};
        let gameData = {};

        // Funciones generales
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            const toggleIcon = document.getElementById('toggleIcon');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('show');
            } else {
                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('expanded');
                
                if (sidebar.classList.contains('collapsed')) {
                    toggleIcon.textContent = '‚Ä∫';
                } else {
                    toggleIcon.textContent = '‚Äπ';
                }
            }
        }

        function showGame(gameType) {
            document.getElementById('welcomeScreen').style.display = 'none';
            
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.querySelectorAll('.game-area').forEach(area => {
                area.classList.remove('active');
            });
            
            event.currentTarget.classList.add('active');
            const gameArea = document.getElementById(gameType + 'Game');
            gameArea.classList.add('active');
            currentGameActive = gameType;

            // Auto-inicializar algunos juegos
            if (gameType === 'memory') {
                setTimeout(startMemoryGame, 500);
            } else if (gameType === 'quiz') {
                setTimeout(startQuizGame, 500);
            } else if (gameType === 'words') {
                setTimeout(startWordGame, 500);
            }
        }

        function closeGame() {
            // Limpiar timers
            Object.values(gameTimers).forEach(timer => clearInterval(timer));
            gameTimers = {};
            
            document.querySelectorAll('.game-area').forEach(area => {
                area.classList.remove('active');
            });
            
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.getElementById('welcomeScreen').style.display = 'flex';
            currentGameActive = null;
        }

        // JUEGO DE MEMORIA
        function startMemoryGame() {
            const symbols = ['üåΩ', 'üçÉ', 'üåæ', 'üöú', 'üå±', 'ü•ï', 'üåΩ', 'üçÉ', 'üåæ', 'üöú', 'üå±', 'ü•ï'];
            const shuffled = symbols.sort(() => Math.random() - 0.5);
            
            const grid = document.getElementById('memoryGrid');
            grid.innerHTML = '';
            
            gameData.memory = {
                cards: shuffled,
                flipped: [],
                matched: [],
                moves: 0,
                pairs: 0,
                startTime: Date.now()
            };
            
            shuffled.forEach((symbol, index) => {
                const card = document.createElement('div');
                card.className = 'memory-card';
                card.dataset.index = index;
                card.dataset.symbol = symbol;
                card.textContent = '?';
                card.onclick = () => flipCard(index);
                grid.appendChild(card);
            });
            
            updateMemoryStats();
            startMemoryTimer();
        }

        function flipCard(index) {
            const card = document.querySelector(`[data-index="${index}"]`);
            const data = gameData.memory;
            
            if (data.flipped.length >= 2 || data.flipped.includes(index) || data.matched.includes(index)) {
                return;
            }
            
            card.classList.add('flipped');
            card.textContent = data.cards[index];
            data.flipped.push(index);
            
            if (data.flipped.length === 2) {
                data.moves++;
                setTimeout(checkMatch, 800);
            }
        }

        function checkMatch() {
            const data = gameData.memory;
            const [first, second] = data.flipped;
            const firstCard = document.querySelector(`[data-index="${first}"]`);
            const secondCard = document.querySelector(`[data-index="${second}"]`);
            
            if (data.cards[first] === data.cards[second]) {
                firstCard.classList.add('matched');
                secondCard.classList.add('matched');
                data.matched.push(first, second);
                data.pairs++;
                
                if (data.pairs === 6) {
                    clearInterval(gameTimers.memory);
                    setTimeout(() => alert('¬°Felicidades! Completaste el juego'), 500);
                }
            } else {
                firstCard.classList.remove('flipped');
                secondCard.classList.remove('flipped');
                firstCard.textContent = '?';
                secondCard.textContent = '?';
            }
            
            data.flipped = [];
            updateMemoryStats();
        }

        function startMemoryTimer() {
            let seconds = 0;
            gameTimers.memory = setInterval(() => {
                seconds++;
                document.getElementById('memoryTime').textContent = seconds;
            }, 1000);
        }

        function updateMemoryStats() {
            const data = gameData.memory;
            document.getElementById('memoryMoves').textContent = data.moves;
            document.getElementById('memoryPairs').textContent = data.pairs;
        }

        // JUEGO QUIZ
        const quizQuestions = [
            {
                question: "¬øCu√°l es el principal cultivo de Chiapas?",
                options: ["Caf√©", "Ma√≠z", "Frijol", "Cacao"],
                correct: 0
            },
            {
                question: "¬øEn qu√© mes se siembra t√≠picamente el ma√≠z en Chiapas?",
                options: ["Enero", "Mayo", "Agosto", "Diciembre"],
                correct: 1
            },
            {
                question: "¬øQu√© plaga afecta m√°s al caf√© en Chiapas?",
                options: ["Gusano cogollero", "Broca del caf√©", "Mosca blanca", "Pulg√≥n"],
                correct: 1
            },
            {
                question: "¬øCu√°l es la mejor √©poca para cosechar caf√© en Chiapas?",
                options: ["Enero-Marzo", "Mayo-Julio", "Septiembre-Noviembre", "Todo el a√±o"],
                correct: 2
            },
            {
                question: "¬øQu√© tipo de suelo es mejor para el cacao?",
                options: ["Arcilloso", "Arenoso", "Franco", "Pedregoso"],
                correct: 2
            }
        ];

        function startQuizGame() {
            gameData.quiz = {
                currentQuestion: 0,
                correctAnswers: 0,
                questions: [...quizQuestions].sort(() => Math.random() - 0.5)
            };
            
            showQuizQuestion();
            updateQuizStats();
        }

        function showQuizQuestion() {
            const data = gameData.quiz;
            const container = document.getElementById('quizContainer');
            const question = data.questions[data.currentQuestion];
            
            container.innerHTML = `
                <div class="quiz-question">
                    <h4>${question.question}</h4>
                    ${question.options.map((option, index) => 
                        `<div class="quiz-option" onclick="selectQuizAnswer(${index})">${option}</div>`
                    ).join('')}
                </div>
            `;
        }

        function selectQuizAnswer(selectedIndex) {
            const data = gameData.quiz;
            const question = data.questions[data.currentQuestion];
            const options = document.querySelectorAll('.quiz-option');
            
            options.forEach((option, index) => {
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedIndex && index !== question.correct) {
                    option.classList.add('incorrect');
                }
                option.onclick = null;
            });
            
            if (selectedIndex === question.correct) {
                data.correctAnswers++;
            }
            
            setTimeout(() => {
                data.currentQuestion++;
                if (data.currentQuestion < data.questions.length) {
                    showQuizQuestion();
                } else {
                    showQuizResults();
                }
                updateQuizStats();
            }, 1500);
        }

        function showQuizResults() {
            const data = gameData.quiz;
            const percentage = Math.round((data.correctAnswers / data.questions.length) * 100);
            const container = document.getElementById('quizContainer');
            
            container.innerHTML = `
                <div style="text-align: center; padding: 30px;">
                    <h3>¬°Quiz Completado!</h3>
                    <p>Respuestas correctas: ${data.correctAnswers}/${data.questions.length}</p>
                    <p>Puntuaci√≥n: ${percentage}%</p>
                    <div style="font-size: 2rem; margin: 20px 0;">
                        ${percentage >= 80 ? 'üèÜ' : percentage >= 60 ? 'üëç' : 'üìö'}
                    </div>
                </div>
            `;
        }

        function updateQuizStats() {
            const data = gameData.quiz;
            if (data) {
                document.getElementById('quizCurrent').textContent = Math.min(data.currentQuestion + 1, data.questions.length);
                document.getElementById('quizCorrect').textContent = data.correctAnswers;
                document.getElementById('quizScore').textContent = data.questions.length > 0 ? 
                    Math.round((data.correctAnswers / Math.max(data.currentQuestion, 1)) * 100) : 0;
            }
        }

        // JUEGO DE C√ÅLCULOS
        function startCalculationGame() {
            gameData.calculations = {
                level: 1,
                correct: 0,
                currentAnswer: '',
                timeLeft: 30,
                currentProblem: null
            };
            
            createNumberPad();
            generateNewProblem();
            startCalculationTimer();
            updateCalculationStats();
        }

        function createNumberPad() {
            const pad = document.getElementById('numberPad');
            pad.innerHTML = '';
            
            for (let i = 1; i <= 9; i++) {
                const btn = document.createElement('button');
                btn.className = 'number-btn';
                btn.textContent = i;
                btn.onclick = () => addToCalcAnswer(i);
                pad.appendChild(btn);
            }
            
            const zeroBtn = document.createElement('button');
            zeroBtn.className = 'number-btn';
            zeroBtn.textContent = '0';
            zeroBtn.onclick = () => addToCalcAnswer(0);
            pad.appendChild(zeroBtn);
        }

        function generateNewProblem() {
            const data = gameData.calculations;
            const max = 10 + (data.level * 5);
            const a = Math.floor(Math.random() * max) + 1;
            const b = Math.floor(Math.random() * max) + 1;
            const operations = ['+', '-', '*'];
            const op = operations[Math.floor(Math.random() * operations.length)];
            
            let result;
            switch (op) {
                case '+': result = a + b; break;
                case '-': result = Math.abs(a - b); break;
                case '*': result = a * b; break;
            }
            
            data.currentProblem = {
                expression: `${a} ${op} ${b}`,
                answer: result
            };
            
            data.currentAnswer = '';
            document.getElementById('calcDisplay').textContent = data.currentProblem.expression + ' = ?';
        }

        function addToCalcAnswer(digit) {
            const data = gameData.calculations;
            data.currentAnswer += digit;
            document.getElementById('calcDisplay').textContent = 
                data.currentProblem.expression + ' = ' + data.currentAnswer;
        }

        function clearCalcInput() {
            if (gameData.calculations) {
                gameData.calculations.currentAnswer = '';
                document.getElementById('calcDisplay').textContent = 
                    gameData.calculations.currentProblem.expression + ' = ?';
            }
        }

        function submitCalcAnswer() {
            const data = gameData.calculations;
            if (!data || !data.currentAnswer) return;
            
            const userAnswer = parseInt(data.currentAnswer);
            if (userAnswer === data.currentProblem.answer) {
                data.correct++;
                data.level = Math.floor(data.correct / 3) + 1;
                generateNewProblem();
            } else {
                document.getElementById('calcDisplay').textContent = 
                    `Incorrecto. Era ${data.currentProblem.answer}`;
                setTimeout(generateNewProblem, 2000);
            }
            
            updateCalculationStats();
        }

        function startCalculationTimer() {
            gameTimers.calculations = setInterval(() => {
                const data = gameData.calculations;
                data.timeLeft--;
                document.getElementById('calcTime').textContent = data.timeLeft;
                
                if (data.timeLeft <= 0) {
                    clearInterval(gameTimers.calculations);
                    document.getElementById('calcDisplay').textContent = 
                        `¬°Tiempo agotado! Correctas: ${data.correct}`;
                }
            }, 1000);
        }

        function updateCalculationStats() {
            const data = gameData.calculations;
            if (data) {
                document.getElementById('calcLevel').textContent = data.level;
                document.getElementById('calcCorrect').textContent = data.correct;
            }
        }

        // JUEGO DE PALABRAS
        const agricultureWords = [
            'MAIZ', 'CAFE', 'FRIJOL', 'CACAO', 'ARADO', 'TIERRA', 'AGUA', 'SOL',
            'CULTIVO', 'COSECHA', 'CAMPO', 'GRANJA', 'SEMILLA', 'PLANTA', 'FRUTO'
        ];

        const wordBases = ['AGRICULTURA', 'CULTIVO', 'COSECHA', 'PLANTACION'];

        function startWordGame() {
            const baseWord = wordBases[Math.floor(Math.random() * wordBases.length)];
            
            gameData.words = {
                baseWord: baseWord,
                foundWords: [],
                score: 0,
                timeLeft: 120
            };
            
            document.getElementById('wordLetters').textContent = baseWord;
            document.getElementById('wordInput').value = '';
            document.getElementById('wordFeedback').textContent = '';
            document.getElementById('wordsList').textContent = '';
            
            startWordTimer();
            updateWordStats();
        }

        function checkWordInput(event) {
            if (event.key === 'Enter') {
                const input = event.target.value.toUpperCase().trim();
                const data = gameData.words;
                
                if (input.length < 3) {
                    showWordFeedback('La palabra debe tener al menos 3 letras', 'red');
                    return;
                }
                
                if (data.foundWords.includes(input)) {
                    showWordFeedback('Ya encontraste esta palabra', 'orange');
                    return;
                }
                
                if (!canMakeWord(input, data.baseWord)) {
                    showWordFeedback('No puedes formar esta palabra con las letras disponibles', 'red');
                    return;
                }
                
                if (isValidWord(input)) {
                    data.foundWords.push(input);
                    data.score += input.length * 10;
                    showWordFeedback('¬°Palabra correcta! +' + (input.length * 10) + ' puntos', 'green');
                    updateWordsList();
                } else {
                    showWordFeedback('Palabra no v√°lida', 'red');
                }
                
                event.target.value = '';
                updateWordStats();
            }
        }

        function canMakeWord(word, baseWord) {
            const baseCounts = {};
            const wordCounts = {};
            
            for (let char of baseWord) {
                baseCounts[char] = (baseCounts[char] || 0) + 1;
            }
            
            for (let char of word) {
                wordCounts[char] = (wordCounts[char] || 0) + 1;
            }
            
            for (let char in wordCounts) {
                if (!baseCounts[char] || wordCounts[char] > baseCounts[char]) {
                    return false;
                }
            }
            
            return true;
        }

        function isValidWord(word) {
            const validWords = [
                'AGUA', 'ARAR', 'GRANO', 'TIERRA', 'CULTURA', 'RURAL', 'RITUAL',
                'CRUEL', 'LUNAR', 'ULTRA', 'LUGAR', 'CURA', 'CUAL', 'GULA',
                'MAIZ', 'CAFE', 'CAMPO', 'COSTA', 'COSA', 'LOCA', 'COLA',
                'LUCHA', 'CULPA', 'GRUTA', 'ULTRA', 'CULT', 'CUT', 'LUT',
                'TU', 'LA', 'AL', 'AH', 'GUL'
            ];
            return validWords.includes(word) || word.length >= 6;
        }

        function showWordFeedback(message, color) {
            const feedback = document.getElementById('wordFeedback');
            feedback.textContent = message;
            feedback.style.color = color;
            setTimeout(() => {
                feedback.textContent = '';
            }, 3000);
        }

        function updateWordsList() {
            const data = gameData.words;
            const list = document.getElementById('wordsList');
            list.textContent = data.foundWords.join(', ');
        }

        function startWordTimer() {
            gameTimers.words = setInterval(() => {
                const data = gameData.words;
                data.timeLeft--;
                document.getElementById('wordsTime').textContent = data.timeLeft;
                
                if (data.timeLeft <= 0) {
                    clearInterval(gameTimers.words);
                    showWordFeedback('¬°Tiempo agotado!', 'red');
                }
            }, 1000);
        }

        function updateWordStats() {
            const data = gameData.words;
            if (data) {
                document.getElementById('wordsFound').textContent = data.foundWords.length;
                document.getElementById('wordsScore').textContent = data.score;
            }
        }

        // JUEGO DE REFLEJOS
        let reactionState = 'waiting';
        let reactionStartTime = 0;
        let reactionTimes = [];

        function handleReactionClick() {
            const circle = document.getElementById('reactionCircle');
            const result = document.getElementById('reactionResult');
            
            switch (reactionState) {
                case 'waiting':
                    circle.textContent = 'Espera el verde...';
                    circle.className = 'reaction-circle wait';
                    reactionState = 'ready';
                    
                    setTimeout(() => {
                        if (reactionState === 'ready') {
                            circle.textContent = '¬°AHORA!';
                            circle.className = 'reaction-circle active';
                            reactionState = 'active';
                            reactionStartTime = Date.now();
                        }
                    }, Math.random() * 3000 + 1000);
                    break;
                    
                case 'ready':
                    circle.textContent = '¬°Muy pronto! Intenta de nuevo';
                    circle.className = 'reaction-circle';
                    result.textContent = 'Hiciste clic muy pronto. Espera el verde.';
                    result.style.color = 'red';
                    reactionState = 'waiting';
                    break;
                    
                case 'active':
                    const reactionTime = Date.now() - reactionStartTime;
                    reactionTimes.push(reactionTime);
                    
                    circle.textContent = 'Haz clic para reiniciar';
                    circle.className = 'reaction-circle';
                    
                    const best = Math.min(...reactionTimes);
                    const avg = Math.round(reactionTimes.reduce((a, b) => a + b) / reactionTimes.length);
                    
                    result.textContent = `Tiempo de reacci√≥n: ${reactionTime}ms`;
                    result.style.color = reactionTime < 300 ? 'green' : reactionTime < 500 ? 'orange' : 'red';
                    
                    document.getElementById('reactionBest').textContent = best;
                    document.getElementById('reactionAvg').textContent = avg;
                    document.getElementById('reactionTries').textContent = reactionTimes.length;
                    
                    reactionState = 'waiting';
                    break;
            }
        }

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            // Responsive sidebar
            if (window.innerWidth <= 768) {
                document.getElementById('sidebar').classList.add('collapsed');
            }
        });

        window.addEventListener('resize', function() {
            if (window.innerWidth <= 768) {
                document.getElementById('sidebar').classList.remove('collapsed');
            }
        });
    </script>
</body>
</html>